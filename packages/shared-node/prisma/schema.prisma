generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Schema {
  id          String       @id @unique
  states      State[]
  transitions Transition[]
  actions     Action[]
}

model State {
  id           String   @id @unique
  Schema       Schema?  @relation(fields: [schemaId], references: [id])
  schemaId     String?
  isStartState Boolean?

  fromFaildtransitions   Transition[] @relation("faildToStateOnTransition")
  fromSuccessTransitions Transition[] @relation("successToStateOnTransition")

  positionX Int?
  positionY Int?

  transitionId String?
  Transition   Transition? @relation("startStateOnTransition")
}

model Transition {
  id String @id @unique

  startFromState   State?  @relation("startStateOnTransition", fields: [startFromStateId], references: [id])
  startFromStateId String? @unique

  faildToState   State?  @relation("faildToStateOnTransition", fields: [faildToStateId], references: [id])
  faildToStateId String?

  successToState   State?  @relation("successToStateOnTransition", fields: [successToStateId], references: [id])
  successToStateId String?

  action   Action?  @relation(fields: [actionId], references: [id])
  actionId String?
  Schema   Schema[]
}

model Action {
  id       String  @id @unique
  Schema   Schema? @relation(fields: [schemaId], references: [id])
  schemaId String?

  url         String?
  content     String?
  transitions Transition[]
}
